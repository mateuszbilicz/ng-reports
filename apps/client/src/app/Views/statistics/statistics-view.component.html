<div class="card p-3 surface-card shadow-2 border-round">
    <div class="flex flex-column md:flex-row justify-content-between align-items-center mb-4 gap-3">
        <h2 class="m-0 text-900">Statistics</h2>

        <div class="flex flex-wrap gap-2 align-items-center">
            <p-datepicker [(ngModel)]="dateRange" selectionMode="range" [readonlyInput]="true" placeholder="Date Range"
                [showIcon]="true"></p-datepicker>
            <p-select [options]="samplingOptions" [(ngModel)]="selectedSampling" optionLabel="label" optionValue="value"
                placeholder="Sampling"></p-select>
            <p-button label="Refresh" icon="pi pi-refresh" (onClick)="loadStats()"></p-button>
        </div>
    </div>

    <div class="grid">
        <div class="col-12 md:col-6 lg:col-3">
            <div class="surface-card shadow-1 p-3 border-round">
                <div class="flex justify-content-between mb-3">
                    <div>
                        <span class="block text-500 font-medium mb-3">Total Reports</span>
                        <div class="text-900 font-medium text-xl">{{ stats()?.totalReports || 0 }}</div>
                    </div>
                    <div class="flex align-items-center justify-content-center bg-blue-100 border-round"
                        style="width:2.5rem;height:2.5rem">
                        <i class="pi pi-file text-blue-500 text-xl"></i>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-12 md:col-6 lg:col-3">
            <div class="surface-card shadow-1 p-3 border-round">
                <div class="flex justify-content-between mb-3">
                    <div>
                        <span class="block text-500 font-medium mb-3">Avg/Sample</span>
                        <div class="text-900 font-medium text-xl">{{ stats()?.avgReportsPerSample | number:'1.0-2' }}
                        </div>
                    </div>
                    <div class="flex align-items-center justify-content-center bg-orange-100 border-round"
                        style="width:2.5rem;height:2.5rem">
                        <i class="pi pi-chart-bar text-orange-500 text-xl"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="card mt-4">
        <h5>Reports Over Time</h5>
        @if (chartData) {
        <p-chart type="bar" [data]="chartData" [options]="chartOptions" height="400px"></p-chart>
        } @else {
        <p class="text-center p-4">No data or loading...</p>
        }
    </div>
</div>