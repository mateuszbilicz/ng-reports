<div class="p-4 flex flex-column gap-4 h-full">
    <div class="surface-card p-4 shadow-2 border-round">
        <div
            class="flex flex-column md:flex-row justify-content-between align-items-start md:align-items-center mb-4 gap-3">
            <h1 class="text-2xl font-bold m-0">Statistics</h1>
            <div class="flex align-items-center gap-2">
                <span class="font-medium text-sm">View:</span>
                <p-selectButton [options]="viewOptions" optionLabel="label" optionValue="value"
                    [formControl]="viewControl">
                    <ng-template let-item pTemplate>
                        <i [class]="item.icon + ' mr-2'"></i> {{ item.label }}
                    </ng-template>
                </p-selectButton>
            </div>
        </div>
        <form [formGroup]="filterForm" class="grid formgrid p-fluid">
            <div class="col-12 md:col-2">
                <label class="font-medium text-sm">Sampling</label>
                <div class="text-sm text-500">Dropdown disabled (build error)</div>
            </div>
            <div class="col-12 md:col-3">
                <label class="font-medium text-sm">Date Range</label>
                <div class="text-sm text-500">Date Picker disabled (build error)</div>
            </div>
            <div class="col-12 md:col-2">
                <label class="font-medium text-sm">Severity</label>
                <div class="text-sm text-500">Dropdown disabled (build error)</div>
            </div>
            <div class="col-12 md:col-3">
                <label class="font-medium text-sm">Search</label>
                <span class="p-input-icon-left">
                    <i class="pi pi-search"></i>
                    <input pInputText formControlName="textFilter" placeholder="Search logs/details..." />
                </span>
            </div>
            <div class="col-12 md:col-2 flex align-items-end">
                <button pButton label="Generate" icon="pi pi-refresh" (click)="loadStatistics()"
                    [loading]="isLoading()"></button>
            </div>
        </form>
    </div>
    <div class="flex-1 surface-card p-4 shadow-2 border-round relative">
        @if (isLoading()) {
        <div class="absolute w-full h-full flex align-items-center justify-content-center bg-white-alpha-70 z-5"
            style="top:0; left:0;">
            <i class="pi pi-spin pi-spinner text-4xl text-primary"></i>
        </div>
        }
        @if (viewControl.value === 'chart') {
        <div class="h-full w-full">
            <div class="flex align-items-center justify-content-center h-full text-500">
                Charts disabled due to library incompatibility.
            </div>
        </div>
        } @else {
        <p-table [value]="tableData()" [scrollable]="true" scrollHeight="flex" styleClass="p-datatable-sm">
            <ng-template pTemplate="header">
                <tr>
                    <th>Date</th>
                    <th>Count</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-item>
                <tr>
                    <td>{{ item.date | date:'medium' }}</td>
                    <td>{{ item.count }}</td>
                </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
                <tr>
                    <td colspan="2" class="text-center p-4">No data found.</td>
                </tr>
            </ng-template>
        </p-table>
        }
    </div>
</div>