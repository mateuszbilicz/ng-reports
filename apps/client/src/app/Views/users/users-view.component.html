<div class="card p-3 surface-card shadow-2 border-round">
  <p-toast></p-toast>
  <p-confirmDialog></p-confirmDialog>

  <div class="flex flex-column md:flex-row md:justify-content-between md:align-items-center mb-3 gap-2">
    <h2 class="m-0 text-900">Users</h2>
    <div class="flex gap-2 align-items-center">
            <span class="p-input-icon-left">
                <p-iconField iconPosition="left">
                    <p-inputIcon styleClass="pi pi-search"/>
                    <input type="text" pInputText placeholder="Search..."
                           (input)="dt.filterGlobal($any($event.target).value, 'contains')"/>
                </p-iconField>
            </span>
      <p-button icon="pi pi-refresh" (onClick)="loadUsers()" styleClass="p-button-outlined p-button-secondary"
                pTooltip="Refresh"></p-button>
      <p-button label="New User" icon="pi pi-plus" (onClick)="createNewUser()" styleClass="p-button-primary"
                pTooltip="New User"></p-button>
    </div>
  </div>

  <p-table #dt [value]="users()" [tableStyle]="{ 'min-width': '50rem' }" [globalFilterFields]="['username', 'name']">
    <ng-template pTemplate="header">
      <tr>
        <th>Username</th>
        <th>Name</th>
        <th>Role</th>
        <th>Actions</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-user>
      <tr>
        <td>{{ user.username }}</td>
        <td>{{ user.name }}</td>
        <td>
          <p-tag [value]="getRoleName(user.role)" [severity]="getRoleSeverity(user.role)"></p-tag>
        </td>
        <td>
          <p-button icon="pi pi-pencil" styleClass="p-button-text p-button-warning" (onClick)="editUser(user)"
                    pTooltip="Edit"></p-button>
          <p-button icon="pi pi-trash" styleClass="p-button-text p-button-danger" (onClick)="deleteUser(user)"
                    pTooltip="Delete"></p-button>
        </td>
      </tr>
    </ng-template>
    <ng-template pTemplate="empty">
      <tr>
        <td colspan="4" class="text-center p-4">No users found.</td>
      </tr>
    </ng-template>
  </p-table>
</div>
